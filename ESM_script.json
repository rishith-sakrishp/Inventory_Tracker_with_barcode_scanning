{"files":[{"id":"e502464a-b170-4234-8dc3-cb6d6a286eca","name":"Code","type":"server_js","source":"var ss \u003d SpreadsheetApp.openByUrl(\"https://docs.google.com/spreadsheets/d/1NBrYsCIRhlxWz51IW1XizurJiqsmRQqgZkRQvnQWznk/edit#gid\u003d0\");\n\nvar sheet \u003d ss.getSheetByName(\u0027Items\u0027); // be very careful ... it is the sheet name .. so it should match \n\n/*\nfunction doPost(e){\nvar action \u003d e.parameter.action;\n\nif(action \u003d\u003d \u0027addItem\u0027){\n  return addItem(e);\n\n}\n\n}*/\n\nfunction doGet(e){\n\nvar action \u003d e.parameter.action;\n\n  if(action \u003d\u003d \u0027getItems\u0027){\n    return getItems(e);\n\n  }\n  \n}\n\n\n/*\nfunction addItem(e){\n\nvar date \u003d  new Date();\n\nvar id  \u003d  \"Item\"+sheet.getLastRow(); // Item1\n\nvar itemName \u003d e.parameter.itemName;\n\nvar brand \u003d e.parameter.brand;\n\nsheet.appendRow([date,id,itemName,brand]);\n\n   return ContentService.createTextOutput(\"Success\").setMimeType(ContentService.MimeType.TEXT);\n\n}\n*/\n\n//Item_Code\tDescription\t\tStatus\tBarcode\tSTDSELLPRICE\tSTDBUYPRICE\tSTANDARDCOST\tITEMCATEGORY\tLASTPRICEUPDATEDATE\tPRIMARYSUPPLIER\tSUPPLYMETHOD\tSUPPLYQTY\tLASTRECEIPTDATE\nfunction getItems(e){\n  \n  var records\u003d{};\n \n  var rows \u003d sheet.getRange(2, 1, sheet.getLastRow() - 1,sheet.getLastColumn()).getValues();\n      data \u003d [];\n\n  for (var r \u003d 0, l \u003d rows.length; r \u003c l; r++) {\n    var row     \u003d rows[r],\n        record  \u003d {};\n     record[\u0027Item_Code\u0027] \u003d row[0];\n     record[\u0027Description\u0027] \u003d row[1];\n     record[\u0027Unit\u0027] \u003d  row[2];\n     record[\u0027Status\u0027] \u003d  row[3];\n     record[\u0027Barcode\u0027]\u003d      row[4];\n     record[\u0027STDSELLPRICE\u0027]\u003d      row[5];\n     record[\u0027STDBUYPRICE\u0027] \u003d row[6];\n     record[\u0027STANDARDCOST\u0027] \u003d row[7];\n     record[\u0027ITEMCATEGORY\u0027] \u003d row[8];\n     record[\u0027LASTPRICEUPDATEDATE\u0027] \u003d row[9];\n     record[\u0027PRIMARYSUPPLIER\u0027] \u003d row[10];\n     record[\u0027SUPPLYMETHOD\u0027] \u003d row[11];\n     record[\u0027SUPPLYQTY\u0027] \u003d row[12];\n     record[\u0027Sno\u0027]\u003dr;\n    record[\u0027Location\u0027]\u003d row[14];\n\n    \n    \n    data.push(record);\n    \n   }\n  records.items \u003d data;\n  var result\u003dJSON.stringify(records);\n  return ContentService.createTextOutput(result).setMimeType(ContentService.MimeType.JSON);\n}\n"},{"id":"ca0e7b07-8ab5-49b3-8380-2d2bd2b5e745","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Australia/Sydney\",\n  \"dependencies\": {\n  },\n  \"webapp\": {\n    \"access\": \"ANYONE_ANONYMOUS\",\n    \"executeAs\": \"USER_DEPLOYING\"\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"}]}